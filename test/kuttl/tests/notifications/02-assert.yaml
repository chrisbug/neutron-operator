# Verify notifications TransportURL is created and ready
apiVersion: rabbitmq.openstack.org/v1beta1
kind: TransportURL
metadata:
  name: notifications-neutron-transport
status:
  conditions:
  - message: Setup complete
    reason: Ready
    status: "True"
    type: Ready
  - message: TransportURL completed
    reason: Ready
    status: "True"
    type: TransportURLReady
---
# Verify external notification config
apiVersion: kuttl.dev/v1beta1
kind: TestAssert
commands:
  - script: |
        oc wait --for=condition=Ready -n $NAMESPACE pod -l service=neutron --timeout=180s
        neutron_pod=$(oc get pods -n $NAMESPACE -l service=neutron --field-selector=status.phase=Running -o name | head -1)
        oc rsh -n $NAMESPACE ${neutron_pod} crudini --get /etc/neutron/neutron.conf.d/01-neutron.conf oslo_messaging_notifications driver | grep -q messagingv2
